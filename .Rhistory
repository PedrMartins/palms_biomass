for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$DAP_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$DAP_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T))
}else {
site_class<-   site[site$DAP_cm >= lower_bound &
site$DAP_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T))
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}else{
data_biomass <- data.frame()
for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$altura_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$altura_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T))
}else {
site_class<-   site[site$altura_cm >= lower_bound &
site$altura_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T))
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}
}
result <- data_biomass
return (result)
}
Status_alt <-stats_DBH_Alt (Biomass_palms_archontophoenix,
class= 1, dbh_alt = "alt")
Status_dbh <- stats_DBH_Alt (Biomass_palms_archontophoenix, dbh_alt = "dbh",
class= 1))
Status_dbh <- stats_DBH_Alt (Biomass_palms_archontophoenix, dbh_alt = "dbh",
class= 1)
data_biomass
na.omit(site_class$biomass_seca_g_estimada)
?length
length(
site_class$biomass_seca_g_estimada
)
length(
na.omit(site_class$biomass_seca_g_estimada)
)
View (is.na(Biomass_palms_archontophoenix$biomass_seca_g_estimada))
View (
Biomass_palms_archontophoenix [is.na(Biomass_palms_archontophoenix$biomass_seca_g_estimada),])
stats_DBH_Alt <- function (x,class = 5, dbh_alt="alt"){
site <-  x
diametre_altura <-  c("alt", "dbh")
diametre_altura <- match(dbh_alt, diametre_altura)
if (length(class)==1) {
if (diametre_altura==2){
site_class<-  site [site$DAP_cm<class,]
browser()
data_biomass <- site_class %>%
summarise(dbh_class_cm =  as.character(class),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}else {
site_class<-  site [site$altura_cm<class,]
data_biomass <- site_class %>%
summarise(alt_class_cm =  as.character(class),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}
} else {
if(diametre_altura==2){
data_biomass <- data.frame()
for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$DAP_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$DAP_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}else {
site_class<-   site[site$DAP_cm >= lower_bound &
site$DAP_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}else{
data_biomass <- data.frame()
for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$altura_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$altura_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
}else {
site_class<-   site[site$altura_cm >= lower_bound &
site$altura_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}
}
result <- data_biomass
return (result)
}
Status_alt <-stats_DBH_Alt (Biomass_palms_archontophoenix,
class= 1, dbh_alt = "alt")
Status_alt <-stats_DBH_Alt (Biomass_palms_archontophoenix,
class= 1, dbh_alt = "alt")
Status_alt
stats_DBH_Alt <- function (x,class = 5, dbh_alt="alt"){
site <-  x
diametre_altura <-  c("alt", "dbh")
diametre_altura <- match(dbh_alt, diametre_altura)
if (length(class)==1) {
if (diametre_altura==2){
site_class<-  site [site$DAP_cm<class,]
browser()
data_biomass <- site_class %>%
summarise(dbh_class_cm =  as.character(class),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}else {
site_class<-  site [site$altura_cm<class,]
data_biomass <- site_class %>%
summarise(alt_class_cm =  as.character(class),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}
} else {
if(diametre_altura==2){
data_biomass <- data.frame()
for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$DAP_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$DAP_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}else {
site_class<-   site[site$DAP_cm >= lower_bound &
site$DAP_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}else{
data_biomass <- data.frame()
for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$altura_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$altura_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
}else {
site_class<-   site[site$altura_cm >= lower_bound &
site$altura_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}
}
result <- data_biomass
return (result)
}
Status_alt <-stats_DBH_Alt (Biomass_palms_archontophoenix,
class= 1, dbh_alt = "alt")
Status_alt
Status_dbh <- stats_DBH_Alt (Biomass_palms_archontophoenix, dbh_alt = "dbh",
class= 1)
stats_DBH_Alt <- function (x,class = 5, dbh_alt="alt"){
site <-  x
diametre_altura <-  c("alt", "dbh")
diametre_altura <- match(dbh_alt, diametre_altura)
if (length(class)==1) {
if (diametre_altura==2){
site_class<-  site [site$DAP_cm<class,]
data_biomass <- site_class %>%
summarise(dbh_class_cm =  as.character(class),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}else {
site_class<-  site [site$altura_cm<class,]
data_biomass <- site_class %>%
summarise(alt_class_cm =  as.character(class),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}
} else {
if(diametre_altura==2){
data_biomass <- data.frame()
for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$DAP_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$DAP_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}else {
site_class<-   site[site$DAP_cm >= lower_bound &
site$DAP_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(dbh_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
)
)
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}else{
data_biomass <- data.frame()
for (i in seq_along(class)){
if (i==1){
site_class<-  site [site$altura_cm<class [1],]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[1]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
data_biomass <- rbind(subset_data_bio,data_biomass)
}
lower_bound <- class[i]
upper_bound <- class[i + 1]
if (is.na(upper_bound)==TRUE) {
site_class<-  site [site$altura_cm >= lower_bound,]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(class[i]),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
}else {
site_class<-   site[site$altura_cm >= lower_bound &
site$altura_cm < upper_bound, ]
subset_data_bio <- site_class %>%
summarise(alt_class_cm =  as.character(paste (lower_bound,upper_bound,
sep ="_")),
mean=mean(site_class$biomass_seca_g_estimada,
na.rm = TRUE ),
SD=sd(site_class$biomass_seca_g_estimada,
na.rm = T),
N=length(
na.omit(site_class$biomass_seca_g_estimada)
))
}
data_biomass <- rbind(subset_data_bio,data_biomass)
}
}
}
result <- data_biomass
return (result)
}
Status_dbh <- stats_DBH_Alt (Biomass_palms_archontophoenix, dbh_alt = "dbh",
class=c(1,2,3,4,5,6,7))
Status_dbh
Status_alt <-stats_DBH_Alt (Biomass_palms_archontophoenix,
class= c(1,2,3,4,5,6,7),
dbh_alt = "alt")
Status_alt
Status_alt <-stats_DBH_Alt (Biomass_palms_archontophoenix,
class= c(5,15,30,50,150),
dbh_alt = "alt")
Status_alt
Stats_alt <-stats_DBH_Alt (Biomass_palms_archontophoenix,
class= c(5,15,30,50,150),
dbh_alt = "alt")
colnames(Stats_alt) [-1,]
colnames(Stats_alt)
colnames(Stats_alt[-1,])
colnames(Stats_alt[,-1])
colnames(Stats_alt[,-1])  <- c("mean_biomass","Standard_deviation","Sample")
Stats_alt
colnames(Stats_alt[,-1])  <- c("mean_biomass","Standard_deviation","Sample")
Stats_alt
write.table(Stats_alt, "Stats_alt.csv")
